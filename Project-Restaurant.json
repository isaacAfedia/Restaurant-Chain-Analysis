{"paragraphs":[{"text":"%md\ncreating a dataframe","user":"anonymous","dateUpdated":"2023-04-17T00:45:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>creating a dataframe</p>\n"}]},"apps":[],"jobName":"paragraph_1681691811471_-898133554","id":"20230417-003651_265020542","dateCreated":"2023-04-17T00:36:51+0000","dateStarted":"2023-04-17T00:45:24+0000","dateFinished":"2023-04-17T00:45:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:155"},{"text":"%spark2.spark\nvar city= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/city/cities.csv\"))\n","user":"anonymous","dateUpdated":"2023-04-17T00:54:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"city: org.apache.spark.sql.DataFrame = [id: int, city: string]\n"}]},"apps":[],"jobName":"paragraph_1681692391504_-1924415401","id":"20230417-004631_2020509992","dateCreated":"2023-04-17T00:46:31+0000","dateStarted":"2023-04-17T00:54:33+0000","dateFinished":"2023-04-17T00:54:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:156"},{"text":"%spark2.spark\nvar meal= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/meal/meals.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:00:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"meal: org.apache.spark.sql.DataFrame = [id: int, restaurant_id: int ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1681693094251_1715516630","id":"20230417-005814_493578550","dateCreated":"2023-04-17T00:58:14+0000","dateStarted":"2023-04-17T01:00:41+0000","dateFinished":"2023-04-17T01:00:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:157"},{"text":"%spark2.spark\nvar meal_type= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/meal_type/meal_types.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:02:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"meal_type: org.apache.spark.sql.DataFrame = [id: int, meal_type: string]\n"}]},"apps":[],"jobName":"paragraph_1681693251108_-923629317","id":"20230417-010051_1398553872","dateCreated":"2023-04-17T01:00:51+0000","dateStarted":"2023-04-17T01:02:12+0000","dateFinished":"2023-04-17T01:02:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:158"},{"text":"%spark2.spark\nvar member= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/member/members.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:03:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"member: org.apache.spark.sql.DataFrame = [id: int, first_name: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1681693340637_-1812075824","id":"20230417-010220_1032294865","dateCreated":"2023-04-17T01:02:20+0000","dateStarted":"2023-04-17T01:03:52+0000","dateFinished":"2023-04-17T01:03:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:159"},{"text":"%spark2.spark\nvar monthly_members= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/monthly_members/monthly_member_totals.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:07:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"monthly_members: org.apache.spark.sql.DataFrame = [member_id: int, first_name: string ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1681693438350_1456487031","id":"20230417-010358_1045913051","dateCreated":"2023-04-17T01:03:58+0000","dateStarted":"2023-04-17T01:07:17+0000","dateFinished":"2023-04-17T01:07:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:160"},{"text":"%spark2.spark\nvar order= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/order/orders.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:08:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"order: org.apache.spark.sql.DataFrame = [id: int, date_column: timestamp ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1681693642536_216319256","id":"20230417-010722_94921590","dateCreated":"2023-04-17T01:07:22+0000","dateStarted":"2023-04-17T01:08:01+0000","dateFinished":"2023-04-17T01:08:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:161"},{"text":"%spark2.spark\nvar order_detail= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/order_detail/order_details.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:08:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"order_detail: org.apache.spark.sql.DataFrame = [id: int, order_id: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1681693699111_-1381265446","id":"20230417-010819_1435399547","dateCreated":"2023-04-17T01:08:19+0000","dateStarted":"2023-04-17T01:08:48+0000","dateFinished":"2023-04-17T01:08:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:162"},{"text":"%spark2.spark\nvar restaurant= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/restaurant/restaurants.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:09:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"restaurant: org.apache.spark.sql.DataFrame = [id: int, restaurant_name: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1681693745462_-216353046","id":"20230417-010905_72367519","dateCreated":"2023-04-17T01:09:05+0000","dateStarted":"2023-04-17T01:09:32+0000","dateFinished":"2023-04-17T01:09:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:163"},{"text":"%spark2.spark\nvar restaurant_type= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/restaurant_type/restaurant_types.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:10:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"restaurant_type: org.apache.spark.sql.DataFrame = [id: int, restaurant_type: string]\n"}]},"apps":[],"jobName":"paragraph_1681693776448_968704215","id":"20230417-010936_15453798","dateCreated":"2023-04-17T01:09:36+0000","dateStarted":"2023-04-17T01:10:37+0000","dateFinished":"2023-04-17T01:10:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:164"},{"text":"%spark2.spark\nvar serve_types= (spark.read\n              .option(\"header\", \"true\")                             \n              .option(\"inferSchema\", \"true\")                         \n              .csv(\"/user/maria_dev/project/server_type/serve_types.csv\"))","user":"anonymous","dateUpdated":"2023-04-17T01:12:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"serve_types: org.apache.spark.sql.DataFrame = [id: int, serve_type: string]\n"}]},"apps":[],"jobName":"paragraph_1681693843978_-784673144","id":"20230417-011043_1318676322","dateCreated":"2023-04-17T01:10:43+0000","dateStarted":"2023-04-17T01:12:06+0000","dateFinished":"2023-04-17T01:12:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165"},{"text":"%md\ncreating views\n","user":"anonymous","dateUpdated":"2023-04-17T01:12:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>creating views</p>\n"}]},"apps":[],"jobName":"paragraph_1681693937894_-1384021630","id":"20230417-011217_125423308","dateCreated":"2023-04-17T01:12:17+0000","dateStarted":"2023-04-17T01:12:42+0000","dateFinished":"2023-04-17T01:12:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"text":"%spark2.spark\ncity.createOrReplaceTempView(\"cities\")\nmeal.createOrReplaceTempView(\"meals\")\nmeal_type.createOrReplaceTempView(\"meal_types\")\nmember.createOrReplaceTempView(\"members\")\nmonthly_members.createOrReplaceTempView(\"monthly_member_totals\")\norder.createOrReplaceTempView(\"orders\")\norder_detail.createOrReplaceTempView(\"order_details\")\nrestaurant.createOrReplaceTempView(\"restaurants\")\nrestaurant_type.createOrReplaceTempView(\"restaurant_types\")\nserve_types.createOrReplaceTempView(\"serve_types\")","user":"anonymous","dateUpdated":"2023-04-17T01:21:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1681693930197_-1597003954","id":"20230417-011210_712127087","dateCreated":"2023-04-17T01:12:10+0000","dateStarted":"2023-04-17T01:21:37+0000","dateFinished":"2023-04-17T01:21:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:167"},{"text":"%spark2.sql\nSELECT meals.meal_name, COUNT(order_details.order_id) as num_orders\n\tFROM order_details\n\tJOIN meals ON order_details.meal_id = meals.id\n\tGROUP BY meals.meal_name\tORDER BY num_orders DESC\nLIMIT 10\n","user":"anonymous","dateUpdated":"2023-04-17T01:27:45+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"meal_name\tnum_orders\nMeal 23\t419\nMeal 27\t415\nMeal 22\t403\nMeal 24\t380\nMeal 26\t377\nMeal 25\t372\nMeal 53\t370\nMeal 54\t349\nMeal 332\t347\nMeal 335\t345\n"}]},"apps":[],"jobName":"paragraph_1681694618693_647650133","id":"20230417-012338_324068922","dateCreated":"2023-04-17T01:23:38+0000","dateStarted":"2023-04-17T01:27:21+0000","dateFinished":"2023-04-17T01:27:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168"},{"text":"%spark2.sql\nSELECT restaurants.restaurant_type_id, restaurant_types.restaurant_type, restaurants.city_id, cities.city, SUM(orders.total_order) AS total_revenue \nFROM orders \nJOIN restaurants ON orders.restaurant_id = restaurants.id \nJOIN restaurant_types ON restaurants.restaurant_type_id = restaurant_types.id \nJOIN cities ON restaurants.city_id = cities.id \nGROUP BY restaurants.restaurant_type_id, restaurants.city_id, restaurant_types.restaurant_type, cities.city \nORDER BY total_revenue DESC ","user":"anonymous","dateUpdated":"2023-04-17T07:20:50+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"stackedAreaChart":{"style":"stack"},"pieChart":{},"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"city","index":3,"aggr":"sum"}],"groups":[{"name":"restaurant_type","index":1,"aggr":"sum"}],"values":[{"name":"total_revenue","index":4,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"restaurant_type_id\trestaurant_type\tcity_id\tcity\ttotal_revenue\n1\tFast Food\t2\tRamat Gan\t318638.2899999989\n5\tIndian\t3\tRamat Hasharon\t308465.22000000015\n1\tFast Food\t4\tHerzelia\t305726.2700000009\n2\tAsian\t1\tTel Aviv\t305139.6899999991\n5\tIndian\t4\tHerzelia\t246543.95999999973\n2\tAsian\t5\tGivatayim\t217039.8800000001\n3\tItalian\t3\tRamat Hasharon\t214739.57999999967\n1\tFast Food\t3\tRamat Hasharon\t202698.49999999919\n4\tHomemade\t2\tRamat Gan\t134257.03999999978\n4\tHomemade\t1\tTel Aviv\t126389.10999999983\n4\tHomemade\t4\tHerzelia\t125715.37999999942\n3\tItalian\t1\tTel Aviv\t113836.79000000011\n3\tItalian\t4\tHerzelia\t96717.51\n1\tFast Food\t1\tTel Aviv\t95870.29000000023\n1\tFast Food\t5\tGivatayim\t95467.2099999999\n5\tIndian\t2\tRamat Gan\t92391.69999999987\n2\tAsian\t2\tRamat Gan\t91727.69999999984\n2\tAsian\t4\tHerzelia\t73024.34999999989\n"}]},"apps":[],"jobName":"paragraph_1681695816425_-1017859458","id":"20230417-014336_1645212535","dateCreated":"2023-04-17T01:43:36+0000","dateStarted":"2023-04-17T01:43:45+0000","dateFinished":"2023-04-17T01:43:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:169"},{"text":"%spark2.sql\n","user":"anonymous","dateUpdated":"2023-04-17T03:39:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1681702765454_-1979281031","id":"20230417-033925_530324591","dateCreated":"2023-04-17T03:39:25+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:170"},{"text":"%spark2.sql\nSELECT AVG(total_expense) as avg_monthly_spending\nFROM monthly_member_totals","user":"anonymous","dateUpdated":"2023-04-17T06:26:49+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_monthly_spending\n706.5\n"}]},"apps":[],"jobName":"paragraph_1681695815401_2095159217","id":"20230417-014335_444444006","dateCreated":"2023-04-17T01:43:35+0000","dateStarted":"2023-04-17T01:45:47+0000","dateFinished":"2023-04-17T01:45:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:171"},{"text":"%spark2.sql\nSELECT \n    restaurants.id, \n    restaurants.restaurant_name, \n    restaurant_types.restaurant_type, \n    cities.city, \n    SUM(orders.total_order) AS total_revenue, \n    COUNT(DISTINCT orders.member_id) AS unique_members, \n    AVG(monthly_member_totals.total_expense) AS avg_monthly_spending -- corrected table name\nFROM orders \nJOIN restaurants ON orders.restaurant_id = restaurants.id \nJOIN restaurant_types ON restaurants.restaurant_type_id = restaurant_types.id -- corrected column name\nJOIN cities ON restaurants.city_id = cities.id \nJOIN monthly_member_totals ON orders.member_id = monthly_member_totals.member_id AND orders.date_column = CONCAT(monthly_member_totals.year,'-',monthly_member_totals.month,'-01') -- corrected table name\nGROUP BY restaurants.id, restaurants.restaurant_name, restaurant_types.restaurant_type, cities.city\nORDER BY total_revenue DESC\n","user":"anonymous","dateUpdated":"2023-04-17T13:39:11+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":true,"setting":{"stackedAreaChart":{"style":"stack"},"multiBarChart":{"stacked":true},"lineChart":{}},"commonSetting":{},"keys":[{"name":"restaurant_type","index":2,"aggr":"sum"}],"groups":[{"name":"unique_members","index":5,"aggr":"sum"}],"values":[{"name":"total_revenue","index":4,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\trestaurant_name\trestaurant_type\tcity\ttotal_revenue\tunique_members\tavg_monthly_spending\n10\tRestaurant 10\tHomemade\tRamat Gan\t6724.13\t47\t736.3636363636364\n18\tRestaurant 18\tItalian\tRamat Hasharon\t6303.42\t47\t698.4126984126984\n20\tRestaurant 20\tFast Food\tRamat Gan\t6193.159999999998\t52\t715.7894736842105\n30\tRestaurant 30\tHomemade\tTel Aviv\t6023.9699999999975\t59\t678.5714285714286\n11\tRestaurant 11\tIndian\tHerzelia\t5897.33\t54\t711.6666666666666\n4\tRestaurant 4\tHomemade\tHerzelia\t5619.17\t48\t679.6296296296297\n13\tRestaurant 13\tIndian\tRamat Hasharon\t5452.929999999999\t48\t703.5087719298245\n8\tRestaurant 8\tAsian\tGivatayim\t5353.419999999998\t50\t715.2542372881356\n1\tRestaurant 1\tItalian\tRamat Hasharon\t5236.59\t48\t703.3333333333334\n27\tRestaurant 27\tIndian\tHerzelia\t5220.420000000001\t49\t677.7777777777778\n21\tRestaurant 21\tAsian\tTel Aviv\t4969.82\t54\t729.0322580645161\n19\tRestaurant 19\tAsian\tRamat Gan\t4858.16\t41\t732.6923076923077\n17\tRestaurant 17\tFast Food\tRamat Gan\t4736.8899999999985\t48\t700.0\n15\tRestaurant 15\tFast Food\tHerzelia\t4735.360000000001\t54\t711.4754098360655\n23\tRestaurant 23\tFast Food\tTel Aviv\t4659.62\t50\t685.9649122807018\n25\tRestaurant 25\tItalian\tHerzelia\t4596.0199999999995\t47\t701.9230769230769\n6\tRestaurant 6\tFast Food\tRamat Gan\t4288.87\t49\t687.5\n16\tRestaurant 16\tFast Food\tRamat Hasharon\t4196.26\t44\t709.8039215686274\n9\tRestaurant 9\tFast Food\tHerzelia\t4169.13\t47\t701.8518518518518\n29\tRestaurant 29\tAsian\tGivatayim\t4165.41\t50\t700.0\n14\tRestaurant 14\tFast Food\tRamat Hasharon\t4107.070000000001\t45\t682.6923076923077\n3\tRestaurant 3\tAsian\tHerzelia\t4075.2900000000004\t50\t723.3333333333334\n26\tRestaurant 26\tAsian\tTel Aviv\t4020.630000000001\t49\t755.7692307692307\n2\tRestaurant 2\tIndian\tRamat Hasharon\t3913.38\t44\t709.433962264151\n7\tRestaurant 7\tFast Food\tHerzelia\t3787.2799999999997\t43\t647.0588235294117\n5\tRestaurant 5\tIndian\tRamat Gan\t3410.33\t42\t700.0\n24\tRestaurant 24\tItalian\tTel Aviv\t3259.3800000000006\t39\t730.952380952381\n12\tRestaurant 12\tIndian\tRamat Hasharon\t3231.6399999999994\t46\t700.0\n22\tRestaurant 22\tFast Food\tGivatayim\t3192.289999999999\t47\t700.0\n28\tRestaurant 28\tAsian\tTel Aviv\t3182.1700000000005\t42\t722.4489795918367\n"}]},"apps":[],"jobName":"paragraph_1681695979836_1755054869","id":"20230417-014619_1693610522","dateCreated":"2023-04-17T01:46:19+0000","dateStarted":"2023-04-17T01:57:50+0000","dateFinished":"2023-04-17T01:57:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:172"},{"text":"%spark2.sql\nSELECT \n    Members.monthly_budget,\n    AVG(monthly_member_totals.total_expense) AS avg_monthly_spending, \n    COUNT(DISTINCT monthly_member_totals.member_id) AS unique_members\nFROM monthly_member_totals\nJOIN Members ON monthly_member_totals.member_id = Members.id\nGROUP BY Members.monthly_budget, Members.city_id\nORDER BY Members.monthly_budget ASC\n","user":"anonymous","dateUpdated":"2023-04-17T13:50:50+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"pieChart":{},"lineChart":{"lineWithFocus":false,"forceY":false},"stackedAreaChart":{"style":"stack"},"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"unique_members","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_monthly_spending","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"monthly_budget\tavg_monthly_spending\tunique_members\n500.0\t500.0\t11\n500.0\t500.0\t12\n500.0\t500.0\t5\n500.0\t500.0\t8\n500.0\t500.0\t21\n600.0\t600.0\t7\n600.0\t600.0\t12\n600.0\t600.0\t14\n600.0\t600.0\t16\n600.0\t600.0\t3\n800.0\t800.0\t11\n800.0\t800.0\t7\n800.0\t800.0\t5\n800.0\t800.0\t11\n800.0\t800.0\t13\n1000.0\t1000.0\t7\n1000.0\t1000.0\t6\n1000.0\t1000.0\t16\n1000.0\t1000.0\t9\n1000.0\t1000.0\t6\n"}]},"apps":[],"jobName":"paragraph_1681696737655_58048420","id":"20230417-015857_893318825","dateCreated":"2023-04-17T01:58:57+0000","dateStarted":"2023-04-17T13:30:09+0000","dateFinished":"2023-04-17T13:30:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173"},{"text":"%spark2.sql\nSELECT meal_types.meal_type, SUM(m.price) AS total_revenue FROM meals m JOIN meal_types ON m.meal_type_id = meal_types.id JOIN order_details od ON m.id = od.meal_id JOIN orders o ON od.order_id = o.id GROUP BY meal_types.meal_type ORDER BY total_revenue DESC","user":"anonymous","dateUpdated":"2023-04-17T07:51:44+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"stackedAreaChart":{"style":"stack"}},"commonSetting":{},"keys":[{"name":"meal_type","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"total_revenue","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"meal_type\ttotal_revenue\nCheese\t1251312.7300000095\nVegan\t946083.0000000015\nChicken\t495322.69000000414\nBeef\t471670.04999998154\n"}]},"apps":[],"jobName":"paragraph_1681697254251_-1722437029","id":"20230417-020734_1310003996","dateCreated":"2023-04-17T02:07:34+0000","dateStarted":"2023-04-17T02:13:53+0000","dateFinished":"2023-04-17T02:13:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174"},{"text":"%spark2.sql\nSELECT mb.sex, AVG(m.monthly_budget) AS avg_monthly_spend \nFROM monthly_member_totals m \nJOIN Members mb ON m.member_id = mb.id \nGROUP BY mb.sex\n","user":"anonymous","dateUpdated":"2023-04-17T06:58:19+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sex\tavg_monthly_spend\nF\t2596.7265833333327\nM\t2654.4562000000024\n"}]},"apps":[],"jobName":"paragraph_1681698209230_218861719","id":"20230417-022329_1933220505","dateCreated":"2023-04-17T02:23:29+0000","dateStarted":"2023-04-17T02:23:34+0000","dateFinished":"2023-04-17T02:23:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:175"},{"text":"%spark2.sql\n","user":"anonymous","dateUpdated":"2023-04-17T02:14:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1681697669049_-1215957524","id":"20230417-021429_1926348787","dateCreated":"2023-04-17T02:14:29+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:176"},{"text":"%spark2.sql\n","user":"anonymous","dateUpdated":"2023-04-17T02:14:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1681697656215_571585866","id":"20230417-021416_1199015181","dateCreated":"2023-04-17T02:14:16+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:177"},{"text":"%\n","user":"anonymous","dateUpdated":"2023-04-17T00:46:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1681692324042_-2116697906","id":"20230417-004524_1838198231","dateCreated":"2023-04-17T00:45:24+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:178"}],"name":"Project","id":"2HWU2HGP7","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}